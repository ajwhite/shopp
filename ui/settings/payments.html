<div class="wrap">
	<form action="<?php echo $_SERVER['REQUEST_URI']; ?>" method="post">
	<h2>Payments Settings</h2>
	<?php include("navigation.html"); ?>

	<form name="settings" id="general" method="post" action="<?php echo SHOPP_URI; ?>">
		<table class="form-table"> 
			<tr class="form-field form-required"> 
				<th scope="row" valign="top"><label for="payment-gateway">Payment Gateway</label></th> 
				<td><select name="settings[payment_gateway]" id="payment-gateway">
					<option>Select One&hellip;</option>
					<?php echo menuoptions($gateways,$this->Core->Settings->get('payment_gateway'),true)?>
					</select><br /> 
	            Check this to use shipping. Leave un-checked to disable shipping - helpful if you are only selling subscriptions or downloads.</td>
			</tr>
			<tbody id="payment-settings">
			</tbody>
		</table>
		<p class="submit"><input type="submit" class="button" name="save" value="Save Changes" /></p>
	</form>
</div>

<script type="text/javascript">
$j = jQuery.noConflict();

var settings_callback = new Array();

var addSetting = function (label,field,help) {
	fieldtype = field.type;
	field.type = null;
	if (fieldtype == "text" || fieldtype == "password" || fieldtype == "select")
		help = '<br />'+help;
		
	if (fieldtype == "checkbox" || fieldtype == "radio")
		help = '<label for="'+field.id+'"> '+help+'</label>';

	var row = $j('<tr></tr>').addClass('form-field').appendTo('#payment-settings');
	var heading = $j('<th scope="row" valign="top"></th>').appendTo(row);
	var fieldLabel = $j('<label/>').attr('for',field.id).html(label).appendTo(heading);
	var dataCell = $j('<td></td>').html(' '+help).appendTo(row);

	var input = $j('<input type="'+fieldtype+'" />').attr(field).prependTo(dataCell);

	if (fieldtype == "checkbox")
		var hidden = $j('<input type="hidden" name="'+field.name+'" value="'+field.unchecked+'" />').prependTo(dataCell);
	
}

<?php
foreach ($Processors as $Processor) $Processor->settings();
?>

$j('#payment-gateway').change(function () {
	$j('#payment-settings').empty();
	if (this.value.length > 0) settings_callback[this.value]();
});

settings_callback[$j('#payment-gateway').val()]();

</script>